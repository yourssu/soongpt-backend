-- PT-155 검증 SQL

-- A) 대상 과목 allow GENERAL row에서 UNIVERSITY가 남아있는지
SELECT course_code, COUNT(*) AS remain_university_allow_rows
FROM target
WHERE course_code IN (
  2150078601,2150083201,2150084001,2150084002,2150084003,
  2150084501,2150084601,2150085901,2150128501,2150128601,
  2150129501,2150155001,2150156401,2150386604,2150465601
)
  AND scope_type = 0
  AND student_type = 0
  AND is_denied = 0
GROUP BY course_code
ORDER BY course_code;

-- B) 대상 과목 allow GENERAL row가 DEPARTMENT(2)로 존재하는지
SELECT course_code, COUNT(*) AS department_allow_rows
FROM target
WHERE course_code IN (
  2150078601,2150083201,2150084001,2150084002,2150084003,
  2150084501,2150084601,2150085901,2150128501,2150128601,
  2150129501,2150155001,2150156401,2150386604,2150465601
)
  AND scope_type = 2
  AND student_type = 0
  AND is_denied = 0
GROUP BY course_code
ORDER BY course_code;

-- C) deny row 수 변동 확인 참고용
SELECT course_code, COUNT(*) AS deny_rows
FROM target
WHERE course_code IN (
  2150078601,2150083201,2150084001,2150084002,2150084003,
  2150084501,2150084601,2150085901,2150128501,2150128601,
  2150129501,2150155001,2150156401,2150386604,2150465601
)
  AND is_denied = 1
GROUP BY course_code
ORDER BY course_code;
