# 졸업사정표 전공 필드 케이스 정리

`graduation_summary_builder`에서 **majorFoundation**, **majorRequired**, **majorElective**가 어떻게 채워지는지, 가능한 모든 케이스와 커버 여부를 정리한 문서입니다.

---

## 1. 입력 가능한 행(name) 종류

| 행 이름 예시 | 매처 | 저장 위치 (루프 중) |
|-------------|------|---------------------|
| `학부-전기 15`, `학부-전공기초 15` | 전공기초(전기) | major_foundation |
| `학부-전필 21` (전선/진선 없음) | 전공필수 단독 | major_required |
| `학부-전선 27`, `학부-전공선택 27` (전필 없음) | 전공선택 단독 | major_elective |
| `학부-전필·전선 51`, `학부-전필·전기·전선 66` | 전필+전선 복합 | major_combined |
| `학부-전공 51`, `학부-전공 42` | 전공 복합 총합 | major_combined |

**매칭 순서(중요):** 복합(전필·전선 / 전공) → 전공기초 → 전공필수 단독 → 전공선택 단독.
그래서 `전필·전기·전선` 같은 행은 전기만으로 매칭되지 않고 **복합**으로 먼저 잡힙니다.

---

## 2. 후처리 규칙 (major_combined가 있을 때)

- **major_required 있음** → 복합 = 전필+전선 → 전선 = 복합 − 전필 → **major_elective** = 전선 역산
- **major_required 없고 major_foundation 있음** → 복합 = 전기+전선 또는 전필+전기+전선 → 전선 = 복합 − 전기 → **major_elective** = 전필+전선 역산(progress용)
- **둘 다 없음** → 복합 전체가 전선 → **major_elective** = 복합 그대로

---

## 3. 가능한 모든 케이스와 결과

### 케이스 1: 전기 + 전필 + 전선 (전필·전선 복합)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전기 15, 전필 21, 전필·전선 51 | 전기 15 (요청/이수/충족) | 전필 21 (18 이수) | 전선 30필수, 15이수 (51−21, 33−18) |

**의미:** 전공기초 단독 + 전공필수 단독 + (전필+전선) 복합. 전선은 복합−전필로 역산.
**테스트:** `TestCase1_전기_전필_전선_복합명시` ✅

---

### 케이스 2: 전기 + 전필 + 전선 ("전공" 복합)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전기 15, 전필 21, 전공 51 | 전기 15 | 전필 21 (21 이수) | 전선 30필수, 27이수 (51−21, 48−21) |

**의미:** 복합이 "전공 N" 한 줄로만 오고, 전필 단독이 있으므로 복합 = 전필+전선으로 해석.
**테스트:** `TestCase2_전기_전필_전공복합` ✅

---

### 케이스 3: 전기 + 전선 (전필 없음, "전공" 복합)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전기 15, 전공 42 | 전기 15 | **None** | 전선 27필수, 15이수 (42−15, 30−15) |

**의미:** 전필 단독 행 없음. 복합−전기 = 전선.
**테스트:** `TestCase3_전기_전선_전필없음` ✅

---

### 케이스 4: 전기 단독 + 전필·전기·전선 한 줄 복합 (전필 단독 없음)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전기 15, 전필·전기·전선 66 | 전기 15 | **None** | 전필+전선 51필수, 35이수 (66−15, 50−15) |

**의미:** 전필 단독 행 없음. 복합 한 줄에서 전기만 빼서 **전필+전선** 이수현황을 majorElective로 보냄(progress용).
**테스트:** `TestCase3_1_전기_단독_전필전기전선_복합` ✅

---

### 케이스 5: 전필 + 전선 (전기 없음, "전공" 복합)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전필 21, 전공 51 | **None** | 전필 21 (15 이수) | 전선 30필수, 18이수 (51−21, 33−15) |

**의미:** 전공기초 행 없음. 복합 = 전필+전선, 전선 역산.
**테스트:** `TestCase4_전필_전선_전기없음` ✅

---

### 케이스 6: 전필 + 전선 (전기 없음, "전필·전선" 복합)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전필 21, 전필·전선 51 | **None** | 전필 21 | 전선 30필수, (51−21, 33−15) 등 역산 |

**의미:** 케이스 1에서 전기 행만 없는 형태. 동일 로직.
**테스트:** `TestCase5_전선_satisfied_계산` (전필 + 전필·전선) ✅

---

### 케이스 7: 전선만 단독 (전기/전필 없음)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전공선택 27 | **None** | **None** | 전공선택 27 (해당 행 그대로) |

**의미:** 복합 행 없음. 후처리에서 major_elective를 덮어쓰지 않음 → 루프에서 잡은 전공선택 단독이 그대로 나감.
**테스트:** `TestCase7_매처_충돌_없음::test_전공선택은_elective로` ✅

---

### 케이스 8: 전기만 단독 (전필/전선/복합 없음)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전공기초 15 | 전공기초 15 | **None** | **None** |

**의미:** 복합 없음 → 전선 역산 없음.
**테스트:** `TestCase7_매처_충돌_없음::test_전공기초는_foundation으로` ✅

---

### 케이스 9: "전공" 복합 한 줄만 (전기/전필 단독 없음)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전공 42 | **None** | **None** | 42필수, 42이수(해당 행 그대로) |

**의미:** 전필/전기 단독이 모두 없음 → 후처리에서 “복합 전체 = 전선”으로 처리.
**테스트:** `TestCase5_1_전공_한줄만` ✅

---

### 케이스 10: 전공 관련 행 없음 (교양만 등)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| (전공 관련 없음) | **None** | **None** | **None** |

**테스트:** `TestCase6_null_처리` ✅

---

### 케이스 11: 전필만 단독 (이론상)

| 존재하는 행 | majorFoundation | majorRequired | majorElective |
|-------------|-----------------|---------------|---------------|
| 전필 21 | **None** | 전필 21 | **None** |

**의미:** 복합 없음 → 전선 역산 없음. 전필만 채워짐.
**테스트:** 없음. 필요 시 추가 가능.

---

## 4. 케이스 커버 요약

| # | 케이스 요약 | majorFoundation | majorRequired | majorElective | 테스트 |
|---|-------------|-----------------|---------------|---------------|--------|
| 1 | 전기+전필+전필·전선 | 전기 | 전필 | 전선(역산) | ✅ Case1 |
| 2 | 전기+전필+전공 | 전기 | 전필 | 전선(역산) | ✅ Case2 |
| 3 | 전기+전공(전필없음) | 전기 | None | 전선(역산) | ✅ Case3 |
| 4 | 전기+전필·전기·전선 | 전기 | None | 전필+전선(역산) | ✅ Case3-1 |
| 5 | 전필+전공(전기없음) | None | 전필 | 전선(역산) | ✅ Case4 |
| 6 | 전필+전필·전선(전기없음) | None | 전필 | 전선(역산) | ✅ Case5 |
| 7 | 전공선택만 | None | None | 전공선택 | ✅ Case7 |
| 8 | 전공기초만 | 전공기초 | None | None | ✅ Case7 |
| 9 | 전공 한 줄만 | None | None | 복합=전선 | ✅ Case5-1 |
| 10 | 전공 없음 | None | None | None | ✅ Case6 |
| 11 | 전필만 | None | 전필 | None | 없음 |

---

## 5. progress / WAS 응답 정리

- **majorFoundation** → 전공기초(전기) 이수현황 (해당 행이 있을 때만).
- **majorRequired** → 전공필수(전필) 이수현황. **복합일 때**는 majorElective와 **동일값** (전필 단독 행 없음).
- **majorElective** →
  - 전필/전선이 따로 있으면: **전공선택(전선)** 역산값,
  - 전기 단독 + 전필·전기·전선 한 줄이면: **전필+전선** 역산값(복합−전기),
  - 전기 + 전필·전선(복합 행에 전기 없음)이면: **복합 전체 = 전필+전선** (전기 빼지 않음),
  - 전선만 있으면: 전공선택 단독,
  - 복합만 있으면: 복합 전체를 전선으로.
- **majorRequiredElectiveCombined** → `true`이면 전필·전선이 복합필드. WAS는 공통응답에 `MAJOR_REQUIRED_ELECTIVE_COMBINED` warning 추가. recommend/all의 MAJOR_REQUIRED / MAJOR_ELECTIVE 둘 다 **같은 값**(같은 progress·같은 추천) 전송.

위 케이스들만 있으면 현재 구현으로 **가능한 전공 졸업사정표 패턴은 모두 커버**됩니다.
